<div layout="column">


    <header>
        <acme-navbar></acme-navbar>
    </header>

    <div layout="column" layout-padding>
        <h3>Introduction</h3>
        <p>
            The chart below shows the number of documents, between {{main.startDate | date:'shortDate'}} and
            {{main.endDate | date:'shortDate'}}, which received a certain amount of points or comments. <a
                href="http://www.newscombinator.com">The Newscombinator</a> keeps indexing links from sites like
            Reddit, Ycombinator etc, which have all one thing in common: upvotes drive the popularity of links. The
            first chart shows how popular the links, containing the given keywords, have been over the course of the
            selected date-range.
        </p>

        <form ng-submit="main.loadChart();" flex>

            <div layout="column">

                <div layout="row" layout-fill layout-align="center center" ng-repeat="keywordObj in main.keywords">
                    <md-button type="button" class="md-icon-button md-primary"
                               ng-click="main.keywords.splice($index,1); main.loadChart();">
                        <md-icon>clear</md-icon>
                    </md-button>
                    <md-input-container flex="20">
                        <label>Type</label>
                        <md-select ng-model="keywordObj.type">
                            <md-option ng-value="type" ng-repeat="type in main.keywordTypes">
                                {{type.typeName}}
                            </md-option>
                        </md-select>
                    </md-input-container>
                    <md-input-container flex ng-show="keywordObj.type.type == 'select'">
                        <label>Select a Value</label>
                        <md-select ng-model="keywordObj.keyword">
                            <md-option ng-repeat="value in keywordObj.type.values" value="{{value}}">{{value}}
                            </md-option>
                        </md-select>
                    </md-input-container>
                    <md-input-container flex ng-show="keywordObj.type.type == 'text'">
                        <label>Keyword (e.g. *google.com* or Elon Musk)</label>
                        <input name="url" ng-model="keywordObj.keyword"/>
                    </md-input-container>
                    <md-input-container flex ng-show="keywordObj.type.type == 'datepicker'">
                        <div flex layout layout-align="end center">
                            <span class="md-body-1">Choose a Date</span>
                        </div>
                        <md-datepicker ng-model="keywordObj.keyword" md-placeholder="Choose a Date"></md-datepicker>
                    </md-input-container>
                    <div flex ng-show="keywordObj.type.type == 'slider'" layout-padding="50 0" layout
                         layout-align="center center">
                        <md-slider aria-label="{{type.typeName}}" flex md-discrete ng-model="keywordObj.keyword"
                                   step="{{keywordObj.type.step}}" min="{{keywordObj.type.min}}"
                                   max="{{keywordObj.type.max}}"
                                   ng-change="main.loadChart()">
                        </md-slider>
                    </div>
                </div>


                <div layout="row" layout-fill layout-wrap>
                    <div layout="row" flex>
                        <md-button type="button" class="md-primary md-raised" ng-click="main.addKeyword();" flex>
                            <md-icon>add</md-icon>
                            Add Search Criteria.
                        </md-button>
                        <md-button flex="10" type="submit" class="md-primary">
                            <md-icon>search</md-icon>
                            Search.
                        </md-button>
                    </div>
                </div>
            </div>
        </form>

        <div layout="column" layout-padding>
            <date-chart flex data="main.directivedata"></date-chart>
        </div>
        <div layout="row" layout-padding>
            <weekday-chart flex data="main.directivedata"></weekday-chart>
            <hours-chart flex data="main.directivedata"></hours-chart>
        </div>

        <div layout="row" layout-padding>
            <documents-per-points-chart flex data="main.directivedata"></documents-per-points-chart>
            <documents-on-frontpage-chart flex data="main.directivedata"></documents-on-frontpage-chart>
        </div>
        <div layout="column" layout-padding layout-margin>
<source-chart flex data="main.directivedata"></source-chart>
            <div layout="row">

                <nvd3 flex="25" options="main.charts[4].options" data="main.charts[4].data"></nvd3>
                <nvd3 flex="25" options="main.charts[3].options" data="main.charts[3].data"></nvd3>
                <nvd3 flex options="main.charts[1].options" data="main.charts[1].data"></nvd3>
            </div>
        </div>
        <div layout="row">

            <div flex layout="column">
                <h2>Top Keywords</h2>
                <md-card ng-repeat="result in main.keyword_charts">
                    <md-card-content>

                        <div layout="row">
                            <nvd3 options="main.charts[5].options" data="result.chartdata"></nvd3>
                            <div layout="column">
                                <h2>{{result.keyword.val}}</h2>
                                <p>{{result.keyword.count}} times in total<br/>
                                    {{result.chartdata[0].y}} times {{result.chartdata[0].key}}<br/>
                                    {{result.chartdata[1].y}} times {{result.chartdata[1].key}}</p>
                            </div>
                        </div>


                    </md-card-content>
                </md-card>
            </div>

            <div flex="50" layout="column">
                <h2>Most upvoted</h2>
                <md-card ng-repeat="result in main.topResults">
                    <md-card-content>
                        <h2>{{result.title_link}}</h2>
                        <p><a href="{{result.url}}" target="_blank">{{result.url}}</a></p>
                        <p>{{result.content_short}}</p>
                    </md-card-content>
                    <md-card-footer>
                        <small>Found: {{result.created_at | date:'short'}} &bull;
                            <md-icon>arrow_drop_up</md-icon>
                            {{result.num_total_points}} &bull;
                            <md-icon>forum</md-icon>
                            {{result.num_total_comments}}
                        </small>
                    </md-card-footer>
                </md-card>
            </div>
        </div>
    </div>

</div>
